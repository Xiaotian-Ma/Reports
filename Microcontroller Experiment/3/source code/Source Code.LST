A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     1


MACRO ASSEMBLER A51 V8.02
OBJECT MODULE PLACED IN Source Code.OBJ
ASSEMBLER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\A51.EXE Source Code.asm NOMOD51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;File name: Timer.asm
                       2     ;Description: Íê³ÉÁËÈÎÎñÈµ±ÖÐµÄ¹¦ÄÜ
                       3     ;Designed by:  Ma Xiaotian
                       4     ;Date:2020-5-30
                       5     ;--------------------------------------------------------------
                       6     ;$include (C8051F310.inc)
                +1     7     ;---------------------------------------------------------------------------
                +1     8     ;  
                +1     9     ;  
                +1    10     ;
                +1    11     ;
                +1    12     ;  FILE NAME   : C8051F310.INC
                +1    13     ;  TARGET MCUs : C8051F310, 'F311
                +1    14     ;  DESCRIPTION : Register/bit definitions for the C8051F31x product family.
                +1    15     ;
                +1    16     ;  REVISION 1.3
                +1    17     ;     -- added ESPI0 and PSPI0
                +1    18     ;  REVISION 1.2
                +1    19     ;     -- added VDM0CN (0xff)   
                +1    20     ;
                +1    21     ;  REVISION 1.1
                +1    22     ;     -- changed TARGET MCUs to 'F310, 'F311
                +1    23     ;     -- SPICFG --> SPI0CFG
                +1    24     ;     -- SPICKR --> SPI0CKR
                +1    25     ;     -- SPIDAT --> SPI0DAT
                +1    26     ;     -- removed CLKMUL (0xb9)
                +1    27     ;     -- AMUX0N --> AMX0N
                +1    28     ;     -- AMUX0P --> AMX0P
                +1    29     ;
                +1    30     ;---------------------------------------------------------------------------
                +1    31     
                +1    32     ; BYTE Registers 
  0080          +1    33     P0       DATA  080H     ; PORT 0                                                   
  0081          +1    34     SP       DATA  081H     ; STACK POINTER                                            
  0082          +1    35     DPL      DATA  082H     ; DATA POINTER - LOW BYTE                                  
  0083          +1    36     DPH      DATA  083H     ; DATA POINTER - HIGH BYTE                                 
  0087          +1    37     PCON     DATA  087H     ; POWER CONTROL                                            
  0088          +1    38     TCON     DATA  088H     ; TIMER CONTROL                                            
  0089          +1    39     TMOD     DATA  089H     ; TIMER MODE                                               
  008A          +1    40     TL0      DATA  08AH     ; TIMER 0 - LOW BYTE                                       
  008B          +1    41     TL1      DATA  08BH     ; TIMER 1 - LOW BYTE                                       
  008C          +1    42     TH0      DATA  08CH     ; TIMER 0 - HIGH BYTE                                      
  008D          +1    43     TH1      DATA  08DH     ; TIMER 1 - HIGH BYTE                                      
  008E          +1    44     CKCON    DATA  08EH     ; CLOCK CONTROL                                            
  008F          +1    45     PSCTL    DATA  08FH     ; PROGRAM STORE R/W CONTROL                                
  0090          +1    46     P1       DATA  090H     ; PORT 1                                                   
  0091          +1    47     TMR3CN   DATA  091H     ; TIMER 3 CONTROL                                          
  0092          +1    48     TMR3RLL  DATA  092H     ; TIMER 3 RELOAD LOW                                       
  0093          +1    49     TMR3RLH  DATA  093H     ; TIMER 3 RELOAD HIGH                                      
  0094          +1    50     TMR3L    DATA  094H     ; TIMER 3 LOW BYTE                                         
  0095          +1    51     TMR3H    DATA  095H     ; TIMER 3 HIGH BYTE                                        
  0098          +1    52     SCON0    DATA  098H     ; SERIAL PORT 0 CONTROL                                    
  0099          +1    53     SBUF0    DATA  099H     ; SERIAL PORT 0 BUFFER                                     
  009A          +1    54     CPT1CN   DATA  09AH     ; COMPARATOR 1 CONTROL                                     
  009B          +1    55     CPT0CN   DATA  09BH     ; COMPARATOR 0 CONTROL                                     
  009C          +1    56     CPT1MD   DATA  09CH     ; COMPARATOR 1 MODE                                        
  009D          +1    57     CPT0MD   DATA  09DH     ; COMPARATOR 0 MODE                                        
  009E          +1    58     CPT1MX   DATA  09EH     ; COMPARATOR 1 MUX                                         
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     2

  009F          +1    59     CPT0MX   DATA  09FH     ; COMPARATOR 0 MUX                                         
  00A0          +1    60     P2       DATA  0A0H     ; PORT 2                                                   
  00A1          +1    61     SPI0CFG  DATA  0A1H     ; SPI0 CONFIGURATION                                        
  00A2          +1    62     SPI0CKR  DATA  0A2H     ; SPI0 CLOCK CONFIGURATION                                  
  00A3          +1    63     SPI0DAT  DATA  0A3H     ; SPI0 DATA                                         
  00A4          +1    64     P0MDOUT  DATA  0A4H     ; PORT 0 OUTPUT MODE                                       
  00A5          +1    65     P1MDOUT  DATA  0A5H     ; PORT 1 OUTPUT MODE                                       
  00A6          +1    66     P2MDOUT  DATA  0A6H     ; PORT 2 OUTPUT MODE                                       
  00A7          +1    67     P3MDOUT  DATA  0A7H     ; PORT 3 OUTPUT MODE                                       
  00A8          +1    68     IE       DATA  0A8H     ; INTERRUPT ENABLE                                         
  00A9          +1    69     CLKSEL   DATA  0A9H     ; CLOCK SOURCE SELECT                                      
  00AA          +1    70     EMI0CN   DATA  0AAH     ; EXTERNAL MEMORY INTERFACE CONTROL                        
  00B0          +1    71     P3       DATA  0B0H     ; PORT 3                                                   
  00B1          +1    72     OSCXCN   DATA  0B1H     ; EXTERNAL OSCILLATOR CONTROL                              
  00B2          +1    73     OSCICN   DATA  0B2H     ; INTERNAL OSCILLATOR CONTROL                              
  00B3          +1    74     OSCICL   DATA  0B3H     ; INTERNAL OSCILLATOR CALIBRATION                          
  00B5          +1    75     FLACL    DATA  0B5H     ; FLASH ACCESS LIMIT
  00B6          +1    76     FLSCL    DATA  0B6H     ; FLASH SCALE                                              
  00B7          +1    77     FLKEY    DATA  0B7H     ; FLASH LOCK & KEY                                         
  00B8          +1    78     IP       DATA  0B8H     ; INTERRUPT PRIORITY   
  00BA          +1    79     AMX0N    DATA  0BAH     ; ADC0 MUX NEGATIVE CHANNEL SELECTION                      
  00BB          +1    80     AMX0P    DATA  0BBH     ; ADC0 MUX POSITIVE CHANNEL SELECTION                      
  00BC          +1    81     ADC0CF   DATA  0BCH     ; ADC0 CONFIGURATION                                       
  00BD          +1    82     ADC0L    DATA  0BDH     ; ADC0 DATA LOW                                            
  00BE          +1    83     ADC0H    DATA  0BEH     ; ADC0 DATA HIGH                                           
  00C0          +1    84     SMB0CN   DATA  0C0H     ; SMBUS CONTROL                                            
  00C1          +1    85     SMB0CF   DATA  0C1H     ; SMBUS CONFIGURATION                                      
  00C2          +1    86     SMB0DAT  DATA  0C2H     ; SMBUS DATA                                             
  00C3          +1    87     ADC0GTL  DATA  0C3H     ; ADC0 GREATER-THAN LOW                                    
  00C4          +1    88     ADC0GTH  DATA  0C4H     ; ADC0 GREATER-THAN HIGH                                   
  00C5          +1    89     ADC0LTL  DATA  0C5H     ; ADC0 LESS-THAN LOW                                       
  00C6          +1    90     ADC0LTH  DATA  0C6H     ; ADC0 LESS-THAN HIGH                                      
  00C8          +1    91     TMR2CN   DATA  0C8H     ; TIMER 2 CONTROL                                                
  00CA          +1    92     TMR2RLL  DATA  0CAH     ; TIMER 2 RELOAD LOW                                       
  00CB          +1    93     TMR2RLH  DATA  0CBH     ; TIMER 2 RELOAD HIGH                                      
  00CC          +1    94     TMR2L    DATA  0CCH     ; TIMER 2 LOW BYTE                                         
  00CD          +1    95     TMR2H    DATA  0CDH     ; TIMER 2 HIGH BYTE                                        
  00D0          +1    96     PSW      DATA  0D0H     ; PROGRAM STATUS WORD                                      
  00D1          +1    97     REF0CN   DATA  0D1H     ; VOLTAGE REFERENCE 0 CONTROL                              
  00D4          +1    98     P0SKIP   DATA  0D4H     ; PORT 0 CROSSBAR SKIP                                     
  00D5          +1    99     P1SKIP   DATA  0D5H     ; PORT 1 CROSSBAR SKIP                                     
  00D6          +1   100     P2SKIP   DATA  0D6H     ; PORT 2 CROSSBAR SKIP     
  00D8          +1   101     PCA0CN   DATA  0D8H     ; PCA0 CONTROL                                             
  00D9          +1   102     PCA0MD   DATA  0D9H     ; PCA0 MODE                                                
  00DA          +1   103     PCA0CPM0 DATA  0DAH     ; PCA0 MODULE 0 MODE                                       
  00DB          +1   104     PCA0CPM1 DATA  0DBH     ; PCA0 MODULE 1 MODE                                       
  00DC          +1   105     PCA0CPM2 DATA  0DCH     ; PCA0 MODULE 2 MODE     
  00DD          +1   106     PCA0CPM3 DATA  0DDH     ; PCA0 MODULE 3 MODE                                       
  00DE          +1   107     PCA0CPM4 DATA  0DEH     ; PCA0 MODULE 4 MODE                                    
  00E0          +1   108     ACC      DATA  0E0H     ; ACCUMULATOR                                              
  00E1          +1   109     XBR0     DATA  0E1H     ; DIGITAL CROSSBAR CONFIGURATION REGISTER 0                
  00E2          +1   110     XBR1     DATA  0E2H     ; DIGITAL CROSSBAR CONFIGURATION REGISTER 1                
  00E4          +1   111     IT01CF   DATA  0E4H     ; INT0/INT1 CONFIGURATION                                  
  00E6          +1   112     EIE1     DATA  0E6H     ; EXTERNAL INTERRUPT ENABLE 1                     
  00E8          +1   113     ADC0CN   DATA  0E8H     ; ADC 0 CONTROL                                            
  00E9          +1   114     PCA0CPL1 DATA  0E9H     ; PCA0 MODULE 1 CAPTURE/COMPARE REGISTER LOW BYTE          
  00EA          +1   115     PCA0CPH1 DATA  0EAH     ; PCA0 MODULE 1 CAPTURE/COMPARE REGISTER HIGH BYTE         
  00EB          +1   116     PCA0CPL2 DATA  0EBH     ; PCA0 MODULE 2 CAPTURE/COMPARE REGISTER LOW BYTE          
  00EC          +1   117     PCA0CPH2 DATA  0ECH     ; PCA0 MODULE 2 CAPTURE/COMPARE REGISTER HIGH BYTE         
  00ED          +1   118     PCA0CPL3 DATA  0EDH     ; PCA0 MODULE 3 CAPTURE/COMPARE REGISTER LOW BYTE          
  00EE          +1   119     PCA0CPH3 DATA  0EEH     ; PCA0 MODULE 3 CAPTURE/COMPARE REGISTER HIGH BYTE         
  00EF          +1   120     RSTSRC   DATA  0EFH     ; RESET SOURCE                                             
  00F0          +1   121     B        DATA  0F0H     ; B REGISTER                                               
  00F1          +1   122     P0MDIN   DATA  0F1H     ; PORT 0 INPUT MODE REGISTER                               
  00F2          +1   123     P1MDIN   DATA  0F2H     ; PORT 1 INPUT MODE REGISTER                               
  00F3          +1   124     P2MDIN   DATA  0F3H     ; PORT 2 INPUT MODE REGISTER                               
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     3

  00F4          +1   125     P3MDIN   DATA  0F4H     ; PORT 3 INPUT MODE REGISTER                               
  00F6          +1   126     EIP1     DATA  0F6H     ; EXTERNAL INTERRUPT PRIORITY 1
  00F8          +1   127     SPI0CN   DATA  0F8H     ; SPI0 CONTROL                                             
  00F9          +1   128     PCA0L    DATA  0F9H     ; PCA0 COUNTER REGISTER LOW BYTE                           
  00FA          +1   129     PCA0H    DATA  0FAH     ; PCA0 COUNTER REGISTER HIGH BYTE                          
  00FB          +1   130     PCA0CPL0 DATA  0FBH     ; PCA MODULE 0 CAPTURE/COMPARE REGISTER LOW BYTE           
  00FC          +1   131     PCA0CPH0 DATA  0FCH     ; PCA MODULE 0 CAPTURE/COMPARE REGISTER HIGH BYTE          
  00FD          +1   132     PCA0CPL4 DATA  0FDH     ; PCA MODULE 4 CAPTURE/COMPARE REGISTER LOW BYTE           
  00FE          +1   133     PCA0CPH4 DATA  0FEH     ; PCA MODULE 4 CAPTURE/COMPARE REGISTER HIGH BYTE      
  00FF          +1   134     VDM0CN    DATA  0FFH ; VDD MONITOR CONTROL
                +1   135     
                +1   136     ;------------------------------------------------------------------------------
                +1   137     ;BIT DEFINITIONS
                +1   138     ;
                +1   139     ; TCON 88H
  0088          +1   140     IT0      BIT   TCON.0   ; EXT. INTERRUPT 0 TYPE
  0089          +1   141     IE0      BIT   TCON.1   ; EXT. INTERRUPT 0 EDGE FLAG
  008A          +1   142     IT1      BIT   TCON.2   ; EXT. INTERRUPT 1 TYPE
  008B          +1   143     IE1      BIT   TCON.3   ; EXT. INTERRUPT 1 EDGE FLAG
  008C          +1   144     TR0      BIT   TCON.4   ; TIMER 0 ON/OFF CONTROL
  008D          +1   145     TF0      BIT   TCON.5   ; TIMER 0 OVERFLOW FLAG
  008E          +1   146     TR1      BIT   TCON.6   ; TIMER 1 ON/OFF CONTROL
  008F          +1   147     TF1      BIT   TCON.7   ; TIMER 1 OVERFLOW FLAG
                +1   148     
                +1   149     ; SCON0  0x98 
  0098          +1   150     RI0      BIT   SCON0.0  ; RECEIVE INTERRUPT FLAG                                
  0099          +1   151     TI0      BIT   SCON0.1  ; TRANSMIT INTERRUPT FLAG                               
  009A          +1   152     RB80     BIT   SCON0.2  ; RECEIVE BIT 8                                         
  009B          +1   153     TB80     BIT   SCON0.3  ; TRANSMIT BIT 8                                        
  009C          +1   154     REN0     BIT   SCON0.4  ; RECEIVE ENABLE                                        
  009D          +1   155     MCE0     BIT   SCON0.5  ; MULTIPROCESSOR COMMUNICATION ENABLE                   
  009F          +1   156     S0MODE   BIT   SCON0.7  ; SERIAL MODE CONTROL BIT 0                             
                +1   157     
                +1   158     ; IE  0xA8 
  00A8          +1   159     EX0      BIT   IE.0     ; EXTERNAL INTERRUPT 0 ENABLE                           
  00A9          +1   160     ET0      BIT   IE.1     ; TIMER 0 INTERRUPT ENABLE                              
  00AA          +1   161     EX1      BIT   IE.2     ; EXTERNAL INTERRUPT 1 ENABLE                           
  00AB          +1   162     ET1      BIT   IE.3     ; TIMER 1 INTERRUPT ENABLE                              
  00AC          +1   163     ES0      BIT   IE.4     ; UART0 INTERRUPT ENABLE                                
  00AD          +1   164     ET2      BIT   IE.5     ; TIMER 2 INTERRUPT ENABLE                              
  00AE          +1   165     ESPI0    BIT   IE.6     ; SPI0 INTERRUPT ENABLE
  00AF          +1   166     EA       BIT   IE.7     ; GLOBAL INTERRUPT ENABLE                               
                +1   167     
                +1   168     ; IP  0xB8 
  00B8          +1   169     PX0      BIT   IP.0     ; EXTERNAL INTERRUPT 0 PRIORITY                         
  00B9          +1   170     PT0      BIT   IP.1     ; TIMER 0 PRIORITY                                      
  00BA          +1   171     PX1      BIT   IP.2     ; EXTERNAL INTERRUPT 1 PRIORITY                         
  00BB          +1   172     PT1      BIT   IP.3     ; TIMER 1 PRIORITY                                      
  00BC          +1   173     PS0      BIT   IP.4     ; UART0 PRIORITY                                        
  00BD          +1   174     PT2      BIT   IP.5     ; TIMER 2 PRIORITY                                      
  00BE          +1   175     PSPI0    BIT   IP.6     ; SPI0 INTERRUPT PRIORITY
                +1   176     
                +1   177     ; SMB0CN 0xC0 
  00C0          +1   178     SI       BIT   SMB0CN.0 ; SMBUS0 INTERRUPT FLAG                                 
  00C1          +1   179     ACK      BIT   SMB0CN.1 ; ACKNOWLEDGE FLAG                                      
  00C2          +1   180     ARBLOST  BIT   SMB0CN.2 ; ARBITRATION LOST INDICATOR                            
  00C3          +1   181     ACKRQ    BIT   SMB0CN.3 ; ACKNOWLEDGE REQUEST                                   
  00C4          +1   182     STO      BIT   SMB0CN.4 ; STOP FLAG                                             
  00C5          +1   183     STA      BIT   SMB0CN.5 ; START FLAG                                            
  00C6          +1   184     TXMODE   BIT   SMB0CN.6 ; TRANSMIT MODE INDICATOR                               
  00C7          +1   185     MASTER   BIT   SMB0CN.7 ; MASTER/SLAVE INDICATOR                                
                +1   186     
                +1   187     ; TMR2CN 0xC8 
  00C8          +1   188     T2XCLK   BIT   TMR2CN.0 ; TIMER 2 EXTERNAL CLOCK SELECT                         
  00CA          +1   189     TR2      BIT   TMR2CN.2 ; TIMER 2 ON/OFF CONTROL                                
  00CB          +1   190     T2SPLIT  BIT   TMR2CN.3 ; TIMER 2 SPLIT MODE ENABLE                             
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     4

  00CD          +1   191     TF2LEN   BIT   TMR2CN.5 ; TIMER 2 LOW BYTE INTERRUPT ENABLE                     
  00CE          +1   192     TF2L     BIT   TMR2CN.6 ; TIMER 2 LOW BYTE OVERFLOW FLAG                        
  00CF          +1   193     TF2H     BIT   TMR2CN.7 ; TIMER 2 HIGH BYTE OVERFLOW FLAG                       
                +1   194     
                +1   195     ; PSW 0xD0 
  00D0          +1   196     P        BIT   PSW.0    ; ACCUMULATOR PARITY FLAG                               
  00D1          +1   197     F1       BIT   PSW.1    ; USER FLAG 1                                           
  00D2          +1   198     OV       BIT   PSW.2    ; OVERFLOW FLAG                                         
  00D3          +1   199     RS0      BIT   PSW.3    ; REGISTER BANK SELECT 0                                
  00D4          +1   200     RS1      BIT   PSW.4    ; REGISTER BANK SELECT 1                                
  00D5          +1   201     F0       BIT   PSW.5    ; USER FLAG 0                                           
  00D6          +1   202     AC       BIT   PSW.6    ; AUXILIARY CARRY FLAG                                  
  00D7          +1   203     CY       BIT   PSW.7    ; CARRY FLAG                                            
                +1   204     
                +1   205     ; PCA0CN 0xD8H 
  00D8          +1   206     CCF0     BIT   PCA0CN.0 ; PCA0 MODULE 0 CAPTURE/COMPARE FLAG                    
  00D9          +1   207     CCF1     BIT   PCA0CN.1 ; PCA0 MODULE 1 CAPTURE/COMPARE FLAG                    
  00DA          +1   208     CCF2     BIT   PCA0CN.2 ; PCA0 MODULE 2 CAPTURE/COMPARE FLAG                    
  00DB          +1   209     CCF3     BIT   PCA0CN.3 ; PCA0 MODULE 3 CAPTURE/COMPARE FLAG                    
  00DC          +1   210     CCF4     BIT   PCA0CN.4 ; PCA0 MODULE 4 CAPTURE/COMPARE FLAG                    
  00DE          +1   211     CR       BIT   PCA0CN.6 ; PCA0 COUNTER RUN CONTROL                              
  00DF          +1   212     CF       BIT   PCA0CN.7 ; PCA0 COUNTER OVERFLOW FLAG                            
                +1   213     
                +1   214     ; ADC0CN 0xE8H 
  00E8          +1   215     AD0CM0   BIT   ADC0CN.0 ; ADC0 CONVERSION MODE SELECT 0                         
  00E9          +1   216     AD0CM1   BIT   ADC0CN.1 ; ADC0 CONVERSION MODE SELECT 1                         
  00EA          +1   217     AD0CM2   BIT   ADC0CN.2 ; ADC0 CONVERSION MODE SELECT 2                         
  00EB          +1   218     AD0WINT  BIT   ADC0CN.3 ; ADC0 WINDOW COMPARE INTERRUPT FLAG                    
  00EC          +1   219     AD0BUSY  BIT   ADC0CN.4 ; ADC0 BUSY FLAG                                        
  00ED          +1   220     AD0INT   BIT   ADC0CN.5 ; ADC0 CONVERISION COMPLETE INTERRUPT FLAG              
  00EE          +1   221     AD0TM    BIT   ADC0CN.6 ; ADC0 TRACK MODE                                       
  00EF          +1   222     AD0EN    BIT   ADC0CN.7 ; ADC0 ENABLE                                           
                +1   223     
                +1   224     ; SPI0CN 0xF8H 
  00FF          +1   225     SPIF     BIT   SPI0CN.7 ; SPI 0 INTERRUPT FLAG                                  
  00FE          +1   226     WCOL     BIT   SPI0CN.6 ; SPI 0 WRITE COLLISION FLAG                            
  00FD          +1   227     MODF     BIT   SPI0CN.5 ; SPI 0 MODE FAULT FLAG                                 
  00FC          +1   228     RXOVRN   BIT   SPI0CN.4 ; SPI 0 RX OVERRUN FLAG                                 
  00FB          +1   229     NSSMD1   BIT   SPI0CN.3 ; SPI 0 SLAVE SELECT MODE 1                             
  00FA          +1   230     NSSMD0   BIT   SPI0CN.2 ; SPI 0 SLAVE SELECT MODE 0                             
  00F9          +1   231     TXBMT    BIT   SPI0CN.1 ; SPI 0 TRANSMIT BUFFER EMPTY                           
  00F8          +1   232     SPIEN    BIT   SPI0CN.0 ; SPI 0 SPI ENABLE                                      
                     233     
                     234     ;D9 BEEP KINT
  0080               235     LED             BIT P0.0        ;D9»ÆµÆ, µÍµçÆ½ÓÐÐ§
  00B1               236     BEEP    BIT P3.1        ;·äÃùÆ÷, ¸ßµçÆ½ÓÐÐ§
  0081               237     KINT    BIT P0.1        ;¶ÀÁ¢°´¼ü, °´ÏÂÎªµÍµçÆ½
                     238     ;LEDÖ¸Ê¾µÆÕóÁÐ
  00B3               239     DAT_IN  BIT P3.3
  00B4               240     CLK             BIT P3.4
                     241     
0000                 242                     ORG 0000H
0000 020100          243                     LJMP HERE
                     244     
000B                 245                     ORG 000BH
000B 0204EA          246                     LJMP TIMER0             ;TIMER0 1sµÄÊÚÊ±
                     247     
0013                 248                     ORG 0013H
0013 0205C4          249                     LJMP DETECT             ;/INT1 ¼ì²âKINT¼ü                       
                     250     
001B                 251                     ORG 001BH
001B 020575          252                     LJMP TIMER1             ;TIMER1 ¼ì²â°´¼üµÄÏÂ°´  µ¥´ÎÑ­»·Ô¼10ms ÉèÖÃ¸ßÓÅÏÈ¼¶
                                                                          
                     253     
0100                 254                     ORG 0100H
                     255     ;--------------------------------------------------------------         
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     5

                     256                     ;³õÊ¼»¯C8051F310£¬SYSCLK=24.5/4=6.125MHz£¨ÄÚ²¿¾§Õñ£© 
                     257                     ;¹ØWDT
                     258                     ;ÍÆÍì¡¢¿ªÂ©Éè¶¨
                     259                     
                     260                     ;T1,16bits Timer, TCLK=SYSCLK/4, TH1=88H,TL1=05FH
                     261                     ;T1Ò»¸öÖÜÆÚ½üËÆÎª20ms£¬Îª°´¼üÏû¶¶ÒÔ¼°³¤¶Ì°´ÊÚÊ±
                     262                     ;T0,16bits Timer, TCLK=SYSCLK/4, TH0=10H, TL0=0DDH
                     263                     ;T0ÎªÊÂë¹ÜÌá¹©1sµÄÊÚÊ±£¬¾«¶ÈÔ¼ÊÇÃ¿Ð¡Ê±¿ì8s£¨ÒÔÊÖ»úÄÚÖÃ¶¨Ê±Æ÷Îª½ð±ê
                     264                     ;Éè±¸ÐÍºÅOnePlus 6£¬¹Ì¼þÇâOS 10.0.4£©
                     265     ;--------------------------------------------------------------
                     266     
0100 12077E          267     HERE:   LCALL Init_Device
                     268                     ;¹Ø±ÕD1-D8£¬¹Ø±Õ·äÃùÆ÷
0103 C2B1            269                     CLR BEEP
0105 D2B3            270                     SETB DAT_IN
0107 7908            271                     MOV R1, #8
0109 C2B4            272     INIT:   CLR CLK
010B D2B4            273                     SETB CLK
010D D9FA            274                     DJNZ R1, INIT
                     275     
                     276                     ;×ÊÔ´Ê¹ÓÃËµÃ÷
                     277                     ;Ê¹ÓÃÁËÆ¬ÄÚ¾§Õñ£¬²¢4·ÖÆµ×÷ÎªÏµÍ³Ê±ÖÓ¡£1¸öÍâ²¿ÖÐ¶Ï£¬2¸ö¶¨Ê±Æ÷
                     278                     ;ÆäÓà´æ´¢¿Õ¼äµÄÊ¹ÓÃÇé¿öÈçÏÂ 
010F 758150          279                     MOV SP, #50H
0112 7F00            280                     MOV R7, #0              ;R7 ÁÙÊ±±äÁ¿ SETTING²¿·ÖÊ¹ÓÃ
0114 7E00            281                     MOV R6, #0              ;R6     ÁÙÊ±±äÁ¿ DETECT²¿·ÖÊ¹ÓÃ
0116 7D96            282                     MOV R5, #150    ;R5 ÓÃÓÚ¼ÇÂ¼KINTÊÇ·ñ³¤°´
0118 7C00            283                     MOV R4, #0              ;R4     ÁÙÊ±±äÁ¿ ÏÔÊ¾²¿·Ö¹²Í¬Ê¹ÓÃ
011A 7B00            284                     MOV R3, #00H    ;R3 ·ÖÖÓ
011C 7A00            285                     MOV R2, #00H    ;R2 ÃëÖÓ
011E 7900            286                     MOV R1, #0              ;R1 ÁÙÊ±±äÁ¿
0120 7830            287                     MOV R0, #30H    ;R0 Ö¸Ïò30H-33H£¬ÏÔÊ¾»º³åÇø
                     288     
0122 753000          289                     MOV 30H, #0                        
0125 753100          290                     MOV 31H, #0             ;31H&30H·Ö±ðÎªÃëÖÓµÄÊ®Î»¡¢¸öÎ»
0128 753200          291                     MOV 32H, #0             
012B 753300          292                     MOV 33H, #0             ;33H&32H·Ö±ðÎª·ÖÖÓµÄÊ®Î»¡¢¸öÎ»
012E 7534C8          293                     MOV 34H, #200   ;ÓÃÓÚ¿ØÖÆÓÃ»§Éè¶¨Ê±µÄÎ»Ñ¡ÉÁË¸
0131 753519          294                     MOV 35H, #25    ;ÓÃÓÚ1sµÄ¶¨Ê±
0134 753600          295                     MOV 36H, #0             ;ÓÃÓÚ10msµÄ°´¼üÑÓÊ±
0137 753700          296                     MOV 37H, #0             ;ÓÃÓÚ´æ·ÅÓÃ»§Éè¶¨µÄ°´¼üÖµ               
013A 753803          297                     MOV 38H, #3             ;ÓÃÀ´Ö¸Ê¾Éè¶¨Î»µÄÎ»Ñ¡£¬Ä¬ÈÏ×îÏÈÉè¶¨×î¸ßÎ»
013D 753900          298                     MOV 39H, #0             ;ÓÃÀ´Ö¸Ê¾Ê×Ö¼ü°´ÏÂ×´Ì¬
0140 753A00          299                     MOV 3AH, #0
0143 753B00          300                     MOV 3BH, #0             ;ÓÃÀ´´æ·ÅÊ±¼äµÄ°ëÖµ£¬3BHÓÃÀ´´æ·Ö£¬3AHÓÃÀ´´æÃë
0146 753C00          301                     MOV 3CH, #0             ;ÁÙÊ±±äÁ¿
0149 753D00          302                     MOV 3DH, #0             ;ÆÕÍ¨ÉÁË¸ÁÙÊ±±äÁ¿               
014C 753E01          303                     MOV 3EH, #1             ;³¬Ê±ÉÁË¸±äÁ¿
014F 753F1F          304                     MOV 3FH, #31    ;½¥¿ìÉÁË¸±äÁ¿
0152 75401F          305                     MOV 40H, #31    ;½¥¿ìÉÁË¸±äÁ¿
0155 C2D5            306                     CLR F0                  ;ÓÃ»§±êÖ¾Î»F0£¬ÓÃÓÚÌáÊ¾ÊÇ(1)·ñ(0)°´ÏÂ°´¼ü
0157 C2D1            307                     CLR F1                  ;ÓÃ»§±êÖ¾Î»F1£¬ÓÃÓÚÌáÊ¾³¤°´(1)»ò¶Ì°´(0)¼ü
0159 C200            308                     CLR 20H.0               ;ÔÝ´æÓÃ»§±êÖ¾Î»F0£¬ÓÃÓÚÌáÊ¾ÊÇ·ñ°´ÏÂ°´¼ü
015B C201            309                     CLR 20H.1               ;ÔÝ´æÓÃ»§±êÖ¾Î»F1£¬ÓÃÓÚÌáÊ¾³¤°´»ò¶Ì°´¼ü
015D C202            310                     CLR 20H.2               ;ÌáÊ¾ÊÇ(1)·ñ(0)½øÈë³¬Ê±Ä£Ê½
015F C203            311                     CLR 20H.3               ;ÌáÊ¾ÊÇ(1)·ñ(0)½øÈë½¥¿ìÄ£Ê½
0161 C204            312                     CLR 20H.4               ;½¥¿ìÄ£Ê½µÄ¼ÓËÙ±êÖ¾,2ÃëÒ»ÖÜÆÚ
0163 C205            313                     CLR 20H.5               ;½¥¿ìÄ£Ê½ÁÁÃðµÄ¿ØÖÆÎ»
                     314     
                     315                     ;F0Îª0Ê±£¬Ã»ÓÐ°´ÏÂ£»F0Îª1Ê±ÇÒF1Îª0Ê±£¬¶Ì°´£»F0Îª1Ê±ÇÒF1Îª1Ê±£¬³¤°´
                     316     ;--------------------------------------------------------------
                     317     
0165 1201E9          318     MAIN:   LCALL SHOW  
0168 30D5FA          319                     JNB F0, MAIN
016B 10D102          320                     JBC F1, JUMP2   
016E 8056            321                     SJMP JUMP1
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     6

                     322     
                     323     
0170 753803          324     JUMP2:  MOV 38H, #3
0173 120226          325                     LCALL SETTING
0176 753F1F          326                     MOV 3FH, #31
0179 75401F          327                     MOV 40H, #31
                     328             
017C E531            329                     MOV A, 31H
017E 75F00A          330                     MOV B, #10
0181 A4              331                     MUL AB
0182 2530            332                     ADD A, 30H              ;ÃëÖÓµÄ10½øÖÆÊ
0184 75F002          333                     MOV B, #2
0187 84              334                     DIV AB                  ;ÉÌÔÚAÖÐ£¬ÊÇÊ®½øÖÆÊ
0188 75F00A          335                     MOV B, #10
018B 84              336                     DIV AB                  ;Ê®Î»ÔÚAÖÐ£¬¸öÎ»ÔÚBÖÐ
018C 85F03A          337                     MOV 3AH, B
018F 75F010          338                     MOV B, #16
0192 A4              339                     MUL AB                  ;½á¹ûÔÚAÖÐ
0193 253A            340                     ADD A, 3AH
0195 F53A            341                     MOV 3AH, A              ;ÔÝÊ±Ëã³öµÄÃëÖÓµÄ½á¹ûÒÔBCDÐÎÊ½´æÈëÁË3AHÖÐ
0197 E533            342                     MOV A, 33H
0199 75F00A          343                     MOV B, #10
019C A4              344                     MUL AB
019D 2532            345                     ADD A, 32H              ;·ÖÖÓµÄ10½øÖÆÊ
019F 75F002          346                     MOV B, #2
01A2 84              347                     DIV AB                  ;ÉÌÔÚAÖÐ£¬ÓàÊÔÚBÖÐ(Ê®½øÖÆÊ)
01A3 F53C            348                     MOV 3CH, A
01A5 A9F0            349                     MOV R1, B
01A7 B90106          350                     CJNE R1, #1, NEXT6      ;Õû³
01AA E53A            351                     MOV A, 3AH              ;Óà1£¬ÔòÃëÖÓ¼Ó30H
01AC 2430            352                     ADD A, #30H
01AE F53A            353                     MOV 3AH, A              ;¸üÐÂÁË3AHÖÐµÄBCDÂë
01B0 75F00A          354     NEXT6:  MOV B, #10
01B3 E53C            355                     MOV A, 3CH
01B5 84              356                     DIV AB                  ;Ê®Î»ÔÚAÖÐ£¬¸öÎ»ÔÚBÖÐ
01B6 85F03B          357                     MOV 3BH, B
01B9 75F010          358                     MOV B, #16
01BC A4              359                     MUL AB                  ;½á¹ûÔÚAÖÐ
01BD 253B            360                     ADD A, 3BH
01BF F53B            361                     MOV 3BH, A              ;ÃëÖÓµÄ½á¹ûÒÔBCDÂëÐÎÊ½´æÈëÁË3BHÖÐ
                     362             
01C1 C202            363                     CLR 20H.2               ;½«³¬Ê±¼ÆÊ±êÖ¾Î»ÇåÁã
01C3 10D19F          364                     JBC F1, MAIN
                     365                      
                     366                       
01C6 1203E2          367     JUMP1:  LCALL COUNT
01C9 300208          368                     JNB 20H.2, HERE21         ;×îºóµÄ½áÊø
01CC BB9905          369                     CJNE R3, #99H, HERE21
01CF BA5902          370                     CJNE R2, #59H, HERE21
01D2 8008            371                     SJMP JUMP3
01D4 30D5EF          372     HERE21: JNB F0, JUMP1
01D7 10D1EC          373                     JBC F1, JUMP1
01DA 8089            374                     SJMP MAIN
                     375     
                     376     
01DC C28C            377     JUMP3:  CLR TR0
01DE 12046F          378                     LCALL BYE
01E1 30D5F8          379                     JNB F0, JUMP3
01E4 10D189          380                     JBC F1, JUMP2
01E7 80F3            381                     SJMP JUMP3
                     382     ;-------------------------------------------------------------- 
                     383     
01E9                 384     SHOW:   ;¹Ì¶¨ÖµÏÔÊ¾Ä£Ê½
01E9 759000          385                     MOV P1, #0
01EC C2D5            386                     CLR F0
01EE E8              387                     MOV A, R0
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     7

01EF 540F            388                     ANL A, #0FH
01F1 C4              389                     SWAP A
01F2 23              390                     RL A
01F3 23              391                     RL A
01F4 F9              392                     MOV R1, A
01F5 E580            393                     MOV A, P0
01F7 543F            394                     ANL A, #3FH
01F9 49              395                     ORL A, R1                
01FA F580            396                     MOV P0, A               ;Î»Ñ¡´«ËÍ£¬ÏÔÊ¾
01FC E6              397                     MOV A, @R0
01FD 900700          398                     MOV DPTR, #0700H
0200 93              399                     MOVC A, @A+DPTR ;Ñ¡ÔñÏàÓ¦µÄÊ×Ö
0201 F590            400                     MOV P1, A               ;¶ÎÑ¡´«ËÍ
0203 1204D9          401                     LCALL D05MS
                     402     
0206 08              403                     INC R0
0207 E8              404                     MOV A, R0
0208 B434DE          405                     CJNE A, #34H, SHOW
020B 759000          406                     MOV P1, #0
020E 7830            407                     MOV R0, #30H
0210 7C06            408                     MOV R4, #6              ;ÔÙÑÓÊ±3ms£¬´Õ¹»Ò»¸öÖÜÆÚ5ms
0212 1204D9          409     LOOP1:  LCALL D05MS     
0215 DCFB            410                     DJNZ R4, LOOP1
0217 30D50B          411                     JNB F0, EOC3    ;½ûÖ¹´Ó0000¿ªÊ¼
021A BB0008          412                     CJNE R3, #0, EOC3
021D BA0005          413                     CJNE R2, #0, EOC3
0220 20D102          414                     JB F1, EOC3
0223 C2D5            415                     CLR F0
0225                 416     EOC3:
0225 22              417             RET
                     418     
                     419     
                     420     
                     421     
0226                 422     SETTING:;ÏÔÊ¾+ÉÁË¸Î»Ñ¡Éè¶¨
                     423                     ;ÏÔÊ¾
0226 C2D5            424                     CLR F0
0228 759000          425     STA1:   MOV P1, #0
022B E8              426                     MOV A, R0
022C 540F            427                     ANL A, #0FH
022E C4              428                     SWAP A
022F 23              429                     RL A
0230 23              430                     RL A
0231 F9              431                     MOV R1, A
0232 E580            432                     MOV A, P0
0234 543F            433                     ANL A, #3FH
0236 49              434                     ORL A, R1                
0237 F580            435                     MOV P0, A               ;Î»Ñ¡´«ËÍ£¬ÏÔÊ¾
0239 E8              436                     MOV A, R0
023A 540F            437                     ANL A, #0FH
023C B53814          438                     CJNE A, 38H, HERE15       ;ÎÞÐèÉÁË¸µÄÎ»ÔòÌø¹ÏÂÃæµÄÓï¾ä¿é
023F 1534            439                     DEC 34H
0241 E534            440                     MOV A, 34H
0243 C3              441                     CLR C
0244 9464            442                     SUBB A, #100
0246 400B            443                     JC HERE15 
0248 759000          444                     MOV P1, #0                        ;ÉÁË¸
024B B49C0C          445                     CJNE A, #9CH, HERE16
024E 7534C8          446                     MOV 34H, #200
0251 415A            447                     AJMP HERE16
                     448     
0253 E6              449     HERE15: MOV A, @R0
0254 900700          450                     MOV DPTR, #0700H
0257 93              451                     MOVC A, @A+DPTR ;Ñ¡ÔñÏàÓ¦µÄÊ×Ö
0258 F590            452                     MOV P1, A               ;¶ÎÑ¡´«ËÍ
                     453     
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     8

025A                 454     HERE16: 
025A 1204D9          455                     LCALL D05MS
025D 08              456                     INC R0
025E E8              457                     MOV A, R0
025F B434C6          458                     CJNE A, #34H, STA1
0262 759000          459                     MOV P1, #0
0265 7830            460                     MOV R0, #30H
0267 7C06            461                     MOV R4, #6              ;ÔÙÑÓÊ±3ms£¬´Õ¹»Ò»¸öÖÜÆÚ5ms
0269                 462     LOOP2:  
0269 1204D9          463                     LCALL D05MS
026C DCFB            464                     DJNZ R4, LOOP2
                     465     
                     466                     ;°´¼ü¼ì²â²¿·Ö
026E E539            467                     MOV A, 39H
0270 7043            468                     JNZ RELAY1              ;Èç¹û39H=1£¨°´ÏÂ£©£¬¾Í²»ÔÙ½øÐÐÊ×Ö¼üÖµ¼ì²â£¬·À´®¼ü
0272 53A0F0          469                     ANL P2, #0F0H   ;ÐÐÏßÍ¬Ê±Êä³öµÍµçÆ½
0275 E5A0            470                     MOV A, P2
0277 B4F005          471                     CJNE A, #0F0H, TEST1;Èç¹ûKI³öÏÖÁËµÍµçÆ½£¬ÔòËµÃ÷¿ÉÄÜÓÐ°´¼ü°´ÏÂ
027A 20D157          472                     JB F1, RELAY3
027D 80A9            473                     SJMP STA1       ;·ñÔò¶¼Îª¸ßµçÆ½£¬ÔòËµÃ÷Ã»ÓÐ°´¼ü°´ÏÂ£¬·µ»Ø¿ªÍ·
027F                 474     TEST1:   
027F 1201E9          475                     LCALL SHOW
0282 1201E9          476                     LCALL SHOW
0285 E5A0            477                     MOV A, P2
0287 B4F002          478                     CJNE A, #0F0H, NEXT1    ;KIÈÔ³öÏÖµÍµçÆ½£¬ÔòËµÃ÷È·ÊµÓÐ°´¼ü°´ÏÂ
028A 809C            479                     SJMP STA1       ;·ñÔò¶¼Îª¸ßµçÆ½£¬ÔòËµÃ÷Îó´¥£¬ÔÙ´Î·µ»Ø¿ªÍ· 
028C                 480     NEXT1:  
028C 30A409          481                     JNB P2.4, COLUMN0
028F 30A525          482                     JNB P2.5, COLUMN1
0292 30A641          483                     JNB P2.6, COLUMN2
0295 30A75B          484                     JNB P2.7, COLUMN3
0298                 485     COLUMN0:
0298 43A00F          486                     ORL P2, #0FH
029B C2A0            487                     CLR P2.0
029D 30A470          488                     JNB P2.4, K0
02A0 D2A0            489                     SETB P2.0
02A2 C2A1            490                     CLR P2.1
02A4 30A46F          491                     JNB P2.4, K1
02A7 D2A1            492                     SETB P2.1
02A9 C2A2            493                     CLR P2.2
02AB 30A46E          494                     JNB P2.4, K2
02AE D2A2            495                     SETB P2.2
02B0 C2A3            496                     CLR P2.3
02B2 30A46D          497                     JNB P2.4, K3
02B5 6185            498     RELAY1: AJMP HERE9              ;½ÓÐøÌø×ª               
02B7                 499     COLUMN1:
02B7 43A00F          500                     ORL P2, #0FH
02BA C2A0            501                     CLR P2.0
02BC 30A569          502                     JNB P2.5, K4
02BF D2A0            503                     SETB P2.0
02C1 C2A1            504                     CLR P2.1
02C3 30A568          505                     JNB P2.5, K5
02C6 D2A1            506                     SETB P2.1
02C8 C2A2            507                     CLR P2.2
02CA 30A567          508                     JNB P2.5, K6
02CD D2A2            509                     SETB P2.2
02CF C2A3            510                     CLR P2.3
02D1 30A566          511                     JNB P2.5, K7
02D4 61DB            512     RELAY3: AJMP HERE11
02D6                 513     COLUMN2:
02D6 43A00F          514                     ORL P2, #0FH
02D9 C2A0            515                     CLR P2.0
02DB 30A662          516                     JNB P2.6, K8
02DE D2A0            517                     SETB P2.0
02E0 C2A1            518                     CLR P2.1
02E2 30A661          519                     JNB P2.6, K9
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE     9

02E5 D2A1            520                     SETB P2.1
02E7 C2A2            521                     CLR P2.2
02E9 30A660          522                     JNB P2.6, KA
02EC D2A2            523                     SETB P2.2
02EE C2A3            524                     CLR P2.3
02F0 30A65F          525                     JNB P2.6, KB
02F3                 526     COLUMN3:
02F3 43A00F          527                     ORL P2, #0FH
02F6 C2A0            528                     CLR P2.0
02F8 30A75D          529                     JNB P2.7, KC
02FB D2A0            530                     SETB P2.0
02FD C2A1            531                     CLR P2.1
02FF 30A75C          532                     JNB P2.7, KD
0302 D2A1            533                     SETB P2.1
0304 C2A2            534                     CLR P2.2
0306 30A75B          535                     JNB P2.7, KE
0309 D2A2            536                     SETB P2.2
030B C2A3            537                     CLR P2.3
030D 30A75A          538                     JNB P2.7, KF
0310 753700          539     K0:             MOV 37H, #0
0313 020372          540                     LJMP HERE8
0316 753701          541     K1:             MOV 37H, #1
0319 020372          542                     LJMP HERE8 
031C 753702          543     K2:             MOV 37H, #2
031F 020372          544                     LJMP HERE8
0322 753703          545     K3:             MOV 37H, #3
0325 020372          546                     LJMP HERE8
0328 753704          547     K4:             MOV 37H, #4
032B 020372          548                     LJMP HERE8
032E 753705          549     K5:             MOV 37H, #5
0331 020372          550                     LJMP HERE8
0334 753706          551     K6:             MOV 37H, #6
0337 020372          552                     LJMP HERE8
033A 753707          553     K7:             MOV 37H, #7
033D 020372          554                     LJMP HERE8
0340 753708          555     K8:             MOV 37H, #8
0343 020372          556                     LJMP HERE8
0346 753709          557     K9:             MOV 37H, #9
0349 020372          558                     LJMP HERE8
034C 75370E          559     KA:             MOV 37H, #0EH
034F 020385          560                     LJMP HERE9
0352 75370E          561     KB:             MOV 37H, #0EH
0355 020385          562                     LJMP HERE9
0358 75370E          563     KC:             MOV 37H, #0EH
035B 020385          564                     LJMP HERE9
035E 75370E          565     KD:             MOV 37H, #0EH
0361 020385          566                     LJMP HERE9
0364 75370E          567     KE:             MOV 37H, #0EH
0367 020385          568                     LJMP HERE9
036A 75370E          569     KF:             MOV 37H, #0EH   ;ÕâÀïKA-KFÃ»ÓÐºÏ²¢Ð´£¬ÎªÁËÎ´À´Ìí¼Ó¹¦ÄÜÊ±ÕÒÈë¿Ú·½±ã
036D 020385          570                     LJMP HERE9              ;Í³Ò»ÉèÎª0EHµÄÊä³ö£¬·½±ãÏÂÃæµÄÅÐ¶Ï
0370 4128            571     RELAY2: AJMP STA1
                     572     
                     573     
0372 E538            574     HERE8:  MOV A, 38H
0374 B4010B          575                     CJNE A, #1, HERE12      ;¿ØÖÆµ±38H=1Ê±£¬Ö»ÓÐ0-5ÓÐÐ§£¬ÆäÓàµÄ¾ùÎÞÐ§
0377 E537            576                     MOV A, 37H
0379 B40502          577                     CJNE A, #5, HERE13
037C 8004            578                     SJMP HERE12                     ;5ºÏ·¨
037E 4002            579     HERE13: JC HERE12                       ;0-4ºÏ·¨
0380 8003            580                     SJMP HERE9                      ;ÆäÓàµÄ²»ºÏ·¨
0382 753901          581     HERE12: MOV 39H, #1             ;ÒÑ°´ÏÂÓÐÐ§µÄ¼ü£¬´ËÊ±37HºÍ39H¶¼ÌîÈëÁËÏàÓ¦µÄÖµ
0385 53A0F0          582     HERE9:  ANL P2, #0F0H   ;ÐÐÏßÍ¬Ê±Êä³öµÍµçÆ½
0388 E5A0            583                     MOV A, P2
038A B4F0E3          584                     CJNE A, #0F0H, RELAY2 ;µ±ÓÐ°´¼ü°´ÏÂÊ±£¬ÎªÁË±£Ö¤ÏÔÊ¾£¬ÈÔ·µ»ØSETTING
                     585                     
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    10

038D 753900          586                     MOV 39H, #0             ;»Ö¸´ÎªÎ´°´ÏÂµÄ×´Ì¬
0390 E537            587                     MOV A, 37H              ;ABCDEFµÄÉ¸Ñ¡
0392 B40E02          588                     CJNE A, #0EH, HERE14
0395 80D9            589                     SJMP RELAY2     ;ABCDEFÔò»Øµ½¿ªÍ·£¬ÊÓ×÷ÎÞÐ§
0397 E538            590     HERE14: MOV A, 38H              ;µ±ËÉ¿ªºó£¬¸ù¾Ý¼üÈëÖµÐÞ¸ÄÏàÓ¦Î»£¨3210£©
0399 6010            591                     JZ ZERO
039B B40319          592                     CJNE A, #3, NEXT2
039E 853733          593     THREE:  MOV 33H, 37H    ;37HÐ´Èë33HÖÐ£¨·ÖÖÓ¸ßÎ»£©
03A1 E537            594                     MOV A, 37H
03A3 C4              595                     SWAP A
03A4 53030F          596                     ANL 03H, #0FH
03A7 4203            597                     ORL 03H, A              ;37HÐ´ÈëR3¸ß4Î»ÖÐ
03A9 8026            598                     SJMP HERE10
03AB 853730          599     ZERO:   MOV 30H, 37H    ;37HÐ´Èë30HÖÐ£¨ÃëÖÓµÍÎ»£©
03AE E537            600                     MOV A, 37H
03B0 5302F0          601                     ANL 02H, #0F0H
03B3 4202            602                     ORL 02H, A              ;37HÐ´ÈëR2µÍ4Î»ÖÐ
03B5 801A            603                     SJMP HERE10
03B7 B4020C          604     NEXT2:  CJNE A, #2, ONE
03BA 853732          605     TWO:    MOV 32H, 37H    ;37HÐ´Èë32HÖÐ£¨·ÖÖÓµÍÎ»£©
03BD E537            606                     MOV A, 37H
03BF 5303F0          607                     ANL 03H, #0F0H
03C2 4203            608                     ORL 03H, A              ;37HÐ´ÈëR3µÍ4Î»ÖÐ
03C4 800B            609                     SJMP HERE10
03C6 853731          610     ONE:    MOV 31H, 37H
03C9 E537            611                     MOV A, 37H
03CB C4              612                     SWAP A
03CC 53020F          613                     ANL 02H, #0FH   ;37HÐ´ÈëR2¸ß4Î»ÖÐ
03CF 4202            614                     ORL 02H, A
03D1 1538            615     HERE10: DEC 38H
03D3 E538            616                     MOV A, 38H
03D5 B4FF03          617                     CJNE A, #0FFH ,HERE11
03D8 753803          618                     MOV 38H, #3             ;µÈÓÚ0Ê±Òª×¢Òâ38H»Ö¸´Îª3,½øÐÐÑ­»·ÊäÈë
03DB 30D592          619     HERE11: JNB F0, RELAY2  ;ÎÞÐ§KINT½«¼ÌÐø³ÌÐòÄÚÑ­»·£¬´Ó¶ø±£Ö¤Ñ¡Î»µÄÁ¬Ðø
03DE 30D18F          620                     JNB F1, RELAY2  ;¶Ì°´KINT½«¼ÌÐø³ÌÐòÄÚÑ­»·               
03E1 22              621             RET                                     ;³¤°´KINTÔò»áÌø³ö³ÌÐò
                     622     
                     623     
                     624     
                     625     
03E2                 626     COUNT:  ;µ¹¼ÆÊ±+³¬Ê±¼ÆÊ
03E2 D28C            627                     SETB TR0
03E4 20020D          628                     JB 20H.2, TIMEOUT
03E7 BB0105          629                     CJNE R3, #1, NEXT7
03EA BA0002          630                     CJNE R2, #0, NEXT7
03ED D2B1            631                     SETB BEEP                       ;Ò»·ÖÖÓµÄÊ±ºîÏìÒ»ÏÂ
03EF BB002E          632     NEXT7:  CJNE R3, #0, FLASH      ;Ìøµ½ÆÕÍ¨ÉÁË¸
03F2 803A            633                     SJMP ACCEL                      ;Ìøµ½½¥¿ìÉÁË¸
03F4 E53E            634     TIMEOUT:MOV A, 3EH                      ;³¬Ê±Ä£Ê½ 
03F6 B40205          635                     CJNE A, #2, NEXT8
03F9 753E00          636                     MOV 3EH, #0
03FC C280            637                     CLR LED                                 
03FE BB0038          638     NEXT8:  CJNE R3, #0, DISP       
0401 BA0135          639                     CJNE R2, #1, DISP
0404 D2B1            640                     SETB BEEP                       ;³¬Ê±1sÏìÒ»ÏÂ
0406 8031            641                     SJMP DISP
0408 EB              642     HALF:   MOV A, R3
0409 B53B06          643                     CJNE A, 3BH, ZER
040C EA              644                     MOV A, R2
040D B53A02          645                     CJNE A, 3AH, ZER
0410 D2B1            646                     SETB BEEP                       ;Ê±¼ä¹°ëÏìÒ»ÏÂ
0412 BB0024          647     ZER:    CJNE R3, #0, DISP
0415 BA0021          648                     CJNE R2, #0, DISP
0418 D202            649                     SETB 20H.2                      ;µ½ÁË00£º00ÖÃÎ»³¬Ê±±êÖ¾
041A D2B1            650                     SETB BEEP                       ;ÏìÒ»ÏÂ
041C C280            651                     CLR LED                         ;ÁÁÒ»ÏÂ
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    11

041E 8019            652                     SJMP DISP
0420 E53D            653     FLASH:  MOV A, 3DH                      ;ÆÕÍ¨Ä£Ê½
0422 B40305          654                     CJNE A, #3, NEXT9
0425 753D00          655                     MOV 3DH, #0
0428 C280            656                     CLR LED                                 
042A 80DC            657     NEXT9:  SJMP HALF
042C 80B4            658     RELAY4: SJMP COUNT                      ;ÉÏÐÐ½ÓÁ¦
042E EA              659     ACCEL:  MOV A, R2
042F 6004            660                     JZ HERE20
0431 D203            661                     SETB 20H.3                      ;½¥¿ìÄ£Ê½
0433 8002            662                     SJMP NEXT10
0435 C203            663     HERE20: CLR 20H.3               
0437 80CF            664     NEXT10: SJMP HALF
                     665     
                     666     ;ÏÔÊ¾²¿·Ö               
0439 759000          667     DISP:   MOV P1, #0
043C C2D5            668                     CLR F0 
043E E8              669                     MOV A, R0
043F 540F            670                     ANL A, #0FH
0441 C4              671                     SWAP A
0442 23              672                     RL A
0443 23              673                     RL A
0444 F9              674                     MOV R1, A
0445 E580            675                     MOV A, P0
0447 543F            676                     ANL A, #3FH
0449 49              677                     ORL A, R1                
044A F580            678                     MOV P0, A               ;Î»Ñ¡´«ËÍ£¬ÏÔÊ¾
044C E6              679                     MOV A, @R0
044D 900700          680                     MOV DPTR, #0700H
0450 93              681                     MOVC A, @A+DPTR ;Ñ¡ÔñÏàÓ¦µÄÊ×Ö
0451 F590            682                     MOV P1, A               ;¶ÎÑ¡´«ËÍ
                     683     
0453 1204D9          684                     LCALL D05MS
0456 D28C            685                     SETB TR0
                     686     
0458 759000          687                     MOV P1, #0
045B 08              688                     INC R0
045C E8              689                     MOV A, R0
045D B434D9          690                     CJNE A, #34H, DISP
0460 759000          691                     MOV P1, #0
0463 7830            692                     MOV R0, #30H
0465 7906            693                     MOV R1, #6              ;ÔÙÑÓÊ±3ms£¬´Õ¹»Ò»¸öÖÜÆÚ5ms
0467 1204D9          694     LOOP3:  LCALL D05MS
046A D28C            695                     SETB TR0        
046C D9F9            696                     DJNZ R1, LOOP3
046E 22              697             RET
                     698     
                     699     
                     700     
                     701     
046F                 702     BYE:    ;½áÊøÓï
046F 759000          703                     MOV P1, #0
0472 7A00            704                     MOV R2, #0
0474 7B00            705                     MOV R3, #0
0476 753000          706                     MOV 30H, #0
0479 753100          707                     MOV 31H, #0
047C 753200          708                     MOV 32H, #0
047F 753300          709                     MOV 33H, #0
0482 D2B1            710                     SETB BEEP
0484 C280            711                     CLR LED
0486 C2D5            712                     CLR F0
0488 E8              713                     MOV A, R0
0489 540F            714                     ANL A, #0FH
048B C4              715                     SWAP A
048C 23              716                     RL A
048D 23              717                     RL A
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    12

048E F9              718                     MOV R1, A
048F E580            719                     MOV A, P0
0491 543F            720                     ANL A, #3FH
0493 49              721                     ORL A, R1                
0494 F580            722                     MOV P0, A               ;Î»Ñ¡´«ËÍ£¬ÏÔÊ¾
0496 E8              723                     MOV A, R0
0497 900700          724                     MOV DPTR, #0700H
049A 93              725                     MOVC A, @A+DPTR ;Ñ¡ÔñÏàÓ¦µÄÊ×Ö
049B F590            726                     MOV P1, A               ;¶ÎÑ¡´«ËÍ
049D 1204D9          727                     LCALL D05MS
                     728     
04A0 08              729                     INC R0
04A1 E8              730                     MOV A, R0
04A2 B434CA          731                     CJNE A, #34H, BYE
04A5 759000          732                     MOV P1, #0
04A8 7830            733                     MOV R0, #30H
04AA 7C06            734                     MOV R4, #6              ;ÔÙÑÓÊ±3ms£¬´Õ¹»Ò»¸öÖÜÆÚ5ms
04AC 1204D9          735     LOOP15: LCALL D05MS     
04AF DCFB            736                     DJNZ R4, LOOP15
04B1 20D102          737                     JB F1, EOC4
04B4 C2D5            738                     CLR F0
04B6                 739     EOC4:
04B6 22              740             RET
                     741     
                     742     
                     743     
                     744     
                     745     ;D10MS 10ms°´¼ü¼ä¸ô
04B7 C0E0            746     D10MS:  PUSH ACC
04B9 7FFA            747                     MOV R7, #250
04BB DF03            748     LOOP7:  DJNZ R7, LOOP8
04BD D0E0            749                     POP ACC
04BF 22              750                     RET
                     751                     
                     752     
04C0 75363C          753     LOOP8:  MOV 36H, #60
04C3 D536FD          754     LOOP6:  DJNZ 36H, LOOP6
                     755                             
04C6 80F3            756             SJMP LOOP7
                     757     
                     758     
                     759     
                     760     
                     761     ;D1MS 1ms¼ä¸ô
04C8 C0E0            762     D1MS:   PUSH ACC
04CA 7F19            763                     MOV R7, #25
04CC DF03            764     LOOP13: DJNZ R7, LOOP14
04CE D0E0            765                     POP ACC
04D0 22              766                     RET
                     767                     
                     768     
04D1 75363C          769     LOOP14: MOV 36H, #60
04D4 D536FD          770     LOOP12: DJNZ 36H, LOOP12
                     771                             
04D7 80F3            772             SJMP LOOP13
                     773     
                     774     
                     775     
                     776     
                     777     ;D05MS 0.5msÏÔÊ¾¼ä¸ô
04D9 C0E0            778     D05MS:  PUSH ACC
04DB 7FA7            779                     MOV R7, #167
04DD DF03            780     LOOP10: DJNZ R7, LOOP11
04DF D0E0            781                     POP ACC
04E1 22              782                     RET
                     783                     
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    13

                     784     
04E2 753603          785     LOOP11: MOV 36H, #3
04E5 D536FD          786     LOOP9:  DJNZ 36H, LOOP9
                     787                             
04E8 80F3            788             SJMP LOOP10
                     789     
                     790     
                     791     
                     792     ;--------------------------------------------------------------
                     793     
                     794     
                     795     ;TIMER0 1s¶¨Ê±£¬ÐèÑ­»·25´Î
04EA                 796     TIMER0:
04EA C28C            797                     CLR TR0 
04EC 758C0F          798                     MOV TH0, #0FH
04EF 758AB5          799                     MOV TL0, #0B5H
04F2 300315          800                     JNB 20H.3, NEXT13 ;½¥¿ìÄ£Ê½Éæ¼°ÏÂÃæµÄÓï¾ä¿é
04F5 1540            801                     DEC 40H
04F7 E540            802                     MOV A, 40H
04F9 B40105          803                     CJNE A, #1, JUDGE
04FC 853F40          804                     MOV 40H, 3FH            ;ÖØÖÃÎªÁã
04FF B205            805                     CPL 20H.5                       ;ÁÁÃðÇÐ»»
0501 200504          806     JUDGE:  JB 20H.5, NEXT11
0504 D280            807                     SETB LED                        ;20H.5=0£¬µÆÃð 
0506 8002            808                     SJMP NEXT13
0508 C280            809     NEXT11: CLR LED                         ;20H.5=1£¬µÆÁÁ 
050A E535            810     NEXT13: MOV A, 35H
050C 14              811                     DEC A
050D F535            812                     MOV 35H, A 
050F B40062          813                     CJNE A, #0, HERE7       ;ÕâÀïÊÇÐ¡Ñ­»·           
0512 D28C            814                     SETB TR0
0514 B204            815                     CPL 20H.4
0516 300206          816                     JNB 20H.2, NEXT12       
0519 053E            817                     INC 3EH                         ;³¬Ê±Ä£Ê½
051B C203            818                     CLR 20H.3                       ;Çå³20H.3µÄ½¥¿ìÄ£Ê½µÄÖÃÎ»
051D 800C            819                     SJMP NEXT18
051F 300307          820     NEXT12: JNB 20H.3, NEXT17
0522 300408          821                     JNB 20H.4, NEXT14
0525 153F            822                     DEC 3FH
0527 8004            823                     SJMP NEXT14
0529 053D            824     NEXT17: INC 3DH                         ;ÆÕÍ¨Ä£Ê½
052B D280            825     NEXT18: SETB LED                        ;¹ØLED
052D 759000          826     NEXT14: MOV P1, #0
0530 C2B1            827                     CLR BEEP
0532 753519          828     NEXT16: MOV 35H, #25
0535 200229          829     NEXT15: JB 20H.2, HERE17        ;20H.2ÖÃÎ»Ê±½øÈë³¬Ê±¼ÆÊÄ£Ê½
0538 BA0009          830                     CJNE R2, #0, HERE6      ;µ¹¼ÆÊ±Ä£Ê½
053B 7A59            831                     MOV R2, #59H
053D EB              832                     MOV A, R3
053E 2499            833                     ADD A, #99H
0540 D4              834                     DA A
0541 FB              835                     MOV R3, A
0542 8005            836                     SJMP HERE5
0544 EA              837     HERE6:  MOV A, R2
0545 2499            838                     ADD A, #99H
0547 D4              839                     DA A
0548 FA              840                     MOV R2, A
0549 EA              841     HERE5:  MOV A, R2               ;¶Ô30H-33H½øÐÐ¸ü¸Ä
054A 540F            842                     ANL A, #0FH
054C F530            843                     MOV 30H, A
054E EA              844                     MOV A, R2
054F 54F0            845                     ANL A, #0F0H
0551 C4              846                     SWAP A
0552 F531            847                     MOV 31H, A
0554 EB              848                     MOV A, R3
0555 540F            849                     ANL A, #0FH
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    14

0557 F532            850                     MOV 32H, A
0559 EB              851                     MOV A, R3
055A 54F0            852                     ANL A, #0F0H
055C C4              853                     SWAP A
055D F533            854                     MOV 33H, A
055F 8013            855                     SJMP HERE7
0561 BA5909          856     HERE17: CJNE R2, #59H, HERE19
0564 7A00            857                     MOV R2, #00H
0566 EB              858                     MOV A, R3
0567 2401            859                     ADD A, #01H
0569 D4              860                     DA A
056A FB              861                     MOV R3, A
056B 8005            862                     SJMP HERE18
056D EA              863     HERE19: MOV A, R2
056E 2401            864                     ADD A, #01H
0570 D4              865                     DA A
0571 FA              866                     MOV R2, A
0572 80D5            867     HERE18: SJMP HERE5
0574                 868     HERE7:
0574 32              869             RETI
                     870             
                     871                     
                     872     
                     873     
                     874     
                     875     ;TIMER1 Ïû¶¶¡¢³¤°´ÊÚÊ±
0575                 876     TIMER1: 
0575 C28E            877                     CLR TR1
0577 200008          878                     JB 20H.0, HERE1 ;ÒÑ¾­°´ÏÂ£¬20H.0=1£¬¾ÍÌøµ½HERE1
057A BD9612          879                     CJNE R5, #150, HERE3    ;ÕâÐÐÖ¸ÁîÊÇÎªÁËÖØ×°R5µÄÖµµ½150
057D 208102          880     HERE4:  JB KINT, HERE1  ;¼Ù°´£¬µÚÒ»´ÎÊ±¼ä¶ÌÓÚ10ms£¬²»ÖÃ20H.0Îª1
0580 D200            881                     SETB 20H.0              ;20H.0=1        
0582 758DC4          882     HERE1:  MOV TH1, #0C4H
0585 758B30          883                     MOV TL1, #030H
0588 208110          884                     JB KINT, EOCO   
058B DD06            885                     DJNZ R5, EOCD   ;°´ÏÂ£¬ÔÝ¼ÇÎª¶Ì°´£¬ÖÃ20H.0Îª1
058D 8008            886                     SJMP EOCC
058F 7D96            887     HERE3:  MOV R5, #150
0591 80EA            888                     SJMP HERE4              ;ÖØ×°ÍêÔÙÌø»ØÕ³£Ö´ÐÐ
0593 D200            889     EOCD:   SETB 20H.0
0595 8027            890                     SJMP EOCR
0597 D201            891     EOCC:   SETB 20H.1
0599 8023            892                     SJMP EOCR
059B A200            893     EOCO:   MOV C, 20H.0    ;Í³Ò»Êä³ö
059D 5007            894                     JNC NEXT19
059F D2B1            895                     SETB BEEP
05A1 1204D9          896                     LCALL D05MS
05A4 C2B1            897                     CLR BEEP
05A6 92D5            898     NEXT19: MOV F0, C
05A8 A201            899                     MOV C, 20H.1
05AA 500B            900                     JNC NEXT20
05AC C280            901                     CLR LED
05AE D2B1            902                     SETB BEEP
05B0 1204C8          903                     LCALL D1MS
05B3 D280            904                     SETB LED
05B5 C2B1            905                     CLR BEEP
05B7 92D1            906     NEXT20: MOV F1, C
05B9 C3              907                     CLR C                   ;ÇåÀí»º´æ
05BA C200            908                     CLR 20H.0
05BC C201            909                     CLR 20H.1
05BE 5380FF          910     EOCR:   ANL P0, #0FFH   ;Í¨¹¶Á-¸Ä-Ð´Ë¢ÐÂÒ»ÏÂ
05C1 D2AA            911                     SETB EX1
05C3 32              912             RETI
                     913             
                     914     
                     915     
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    15

                     916     
                     917     ;DETECT ÏàÓ¦KINT¼ü
05C4                 918     DETECT: 
05C4 C2AA            919                     CLR EX1                 ;¹ØµôÍâ²¿ÖÐ¶Ï1Ê¹ÄÜ£¬·ÀÖ¹¶à´Î½øÈë¶ÔÏÔÊ¾µÄ¸ÉÈÅ
05C6 D28E            920                     SETB TR1                ;TIMER1¿ªÊ¼¼ÆÊ±£¬Ö§³Ö°´¼üÈ¥¶¶ºÍ³¤¶Ì°´Ê¶±ðµÈ¹¦ÄÜ
05C8 D281            921                     SETB KINT               ;ÖÃ1
05CA 32              922             RETI
                     923     
                     924      
                     925     
                     926     ;---------¶¨Òå¶ÎÂë±í---------------------------------------                                
                                          
0700                 927                     ORG 0700H
0700 FC60DAF2        928     LUT1:   DB 0FCH, 60H, 0DAH, 0F2H        ;0-3
0704 66B6BEE0        929                     DB 66H, 0B6H, 0BEH, 0E0H        ;4-7
0708 FEF6            930                     DB 0FEH, 0F6H                           ;8,9
                     931     
0730                 932                     ORG 0730H
0730 017A2A9E        933     LUT2:   DB 01H, 7AH, 2AH, 9EH           ;End.
                     934                     
                     935     ; Peripheral specific initialization functions,
                     936     ; Called from the Init_Device label
                     937     ;------------------------------------
                     938     ;-  Generated Initialization File  --
                     939     ;------------------------------------
0734                 940     PCA_Init:
0734 53D9BF          941         anl  PCA0MD,    #0BFh
0737 75D900          942         mov  PCA0MD,    #000h
073A 22              943         ret
                     944     
073B                 945     Timer_Init:
073B 758911          946         mov  TMOD,      #011h
073E 758E01          947         mov  CKCON,     #001h
0741 758AB4          948         mov  TL0,       #0B4h
0744 758BF7          949         mov  TL1,       #0F7h
0747 758C0F          950         mov  TH0,       #00Fh
074A 758DC2          951         mov  TH1,       #0C2h
074D 75CAF0          952         mov  TMR2RLL,   #0F0h
0750 75CCF0          953         mov  TMR2L,     #0F0h
0753 7593DC          954         mov  TMR3RLH,   #0DCh
0756 7595DC          955         mov  TMR3H,     #0DCh
0759 22              956         ret
                     957     
075A                 958     Port_IO_Init:
                     959         ; P0.0  -  Unassigned,  Push-Pull,  Digital
                     960         ; P0.1  -  Unassigned,  Open-Drain, Digital
                     961         ; P0.2  -  Skipped,     Push-Pull,  Analog
                     962         ; P0.3  -  Skipped,     Push-Pull,  Analog
                     963         ; P0.4  -  Unassigned,  Open-Drain, Digital
                     964         ; P0.5  -  Unassigned,  Open-Drain, Digital
                     965         ; P0.6  -  Unassigned,  Push-Pull,  Digital
                     966         ; P0.7  -  Unassigned,  Push-Pull,  Digital
                     967     
                     968         ; P1.0  -  Unassigned,  Push-Pull,  Digital
                     969         ; P1.1  -  Unassigned,  Push-Pull,  Digital
                     970         ; P1.2  -  Unassigned,  Push-Pull,  Digital
                     971         ; P1.3  -  Unassigned,  Push-Pull,  Digital
                     972         ; P1.4  -  Unassigned,  Push-Pull,  Digital
                     973         ; P1.5  -  Unassigned,  Push-Pull,  Digital
                     974         ; P1.6  -  Unassigned,  Push-Pull,  Digital
                     975         ; P1.7  -  Unassigned,  Push-Pull,  Digital
                     976         ; P2.0  -  Unassigned,  Push-Pull,  Digital
                     977         ; P2.1  -  Unassigned,  Push-Pull,  Digital
                     978         ; P2.2  -  Unassigned,  Push-Pull,  Digital
                     979         ; P2.3  -  Unassigned,  Push-Pull,  Digital
                     980     
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    16

075A 75F1F3          981         mov  P0MDIN,    #0F3h
075D 75A4CD          982         mov  P0MDOUT,   #0CDh
0760 75A5FF          983         mov  P1MDOUT,   #0FFh
0763 75A60F          984         mov  P2MDOUT,   #00Fh
0766 75A702          985         mov  P3MDOUT,   #002h
0769 75D40C          986         mov  P0SKIP,    #00Ch
076C 75E240          987         mov  XBR1,      #040h
076F 22              988         ret
                     989     
0770                 990     Oscillator_Init:
0770 75B281          991         mov  OSCICN,    #081h
0773 22              992         ret
                     993     
0774                 994     Interrupts_Init:
0774 75B82E          995         mov  IP,        #02Eh
0777 75E414          996         mov  IT01CF,    #014h
077A 75A8AE          997         mov  IE,        #0AEh
077D 22              998         ret
                     999     
                    1000     ; Initialization function for device,
                    1001     ; Call Init_Device from your main program
077E                1002     Init_Device:
077E 120734         1003         lcall PCA_Init
0781 12073B         1004         lcall Timer_Init
0784 12075A         1005         lcall Port_IO_Init
0787 120770         1006         lcall Oscillator_Init
078A 120774         1007         lcall Interrupts_Init
078D 22             1008         ret
                    1009     
                    1010     end
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    17

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

AC . . . . . . . .  B ADDR   00D0H.6 A   
ACC. . . . . . . .  D ADDR   00E0H   A   
ACCEL. . . . . . .  C ADDR   042EH   A   
ACK. . . . . . . .  B ADDR   00C0H.1 A   
ACKRQ. . . . . . .  B ADDR   00C0H.3 A   
AD0BUSY. . . . . .  B ADDR   00E8H.4 A   
AD0CM0 . . . . . .  B ADDR   00E8H.0 A   
AD0CM1 . . . . . .  B ADDR   00E8H.1 A   
AD0CM2 . . . . . .  B ADDR   00E8H.2 A   
AD0EN. . . . . . .  B ADDR   00E8H.7 A   
AD0INT . . . . . .  B ADDR   00E8H.5 A   
AD0TM. . . . . . .  B ADDR   00E8H.6 A   
AD0WINT. . . . . .  B ADDR   00E8H.3 A   
ADC0CF . . . . . .  D ADDR   00BCH   A   
ADC0CN . . . . . .  D ADDR   00E8H   A   
ADC0GTH. . . . . .  D ADDR   00C4H   A   
ADC0GTL. . . . . .  D ADDR   00C3H   A   
ADC0H. . . . . . .  D ADDR   00BEH   A   
ADC0L. . . . . . .  D ADDR   00BDH   A   
ADC0LTH. . . . . .  D ADDR   00C6H   A   
ADC0LTL. . . . . .  D ADDR   00C5H   A   
AMX0N. . . . . . .  D ADDR   00BAH   A   
AMX0P. . . . . . .  D ADDR   00BBH   A   
ARBLOST. . . . . .  B ADDR   00C0H.2 A   
B. . . . . . . . .  D ADDR   00F0H   A   
BEEP . . . . . . .  B ADDR   00B0H.1 A   
BYE. . . . . . . .  C ADDR   046FH   A   
CCF0 . . . . . . .  B ADDR   00D8H.0 A   
CCF1 . . . . . . .  B ADDR   00D8H.1 A   
CCF2 . . . . . . .  B ADDR   00D8H.2 A   
CCF3 . . . . . . .  B ADDR   00D8H.3 A   
CCF4 . . . . . . .  B ADDR   00D8H.4 A   
CF . . . . . . . .  B ADDR   00D8H.7 A   
CKCON. . . . . . .  D ADDR   008EH   A   
CLK. . . . . . . .  B ADDR   00B0H.4 A   
CLKSEL . . . . . .  D ADDR   00A9H   A   
COLUMN0. . . . . .  C ADDR   0298H   A   
COLUMN1. . . . . .  C ADDR   02B7H   A   
COLUMN2. . . . . .  C ADDR   02D6H   A   
COLUMN3. . . . . .  C ADDR   02F3H   A   
COUNT. . . . . . .  C ADDR   03E2H   A   
CPT0CN . . . . . .  D ADDR   009BH   A   
CPT0MD . . . . . .  D ADDR   009DH   A   
CPT0MX . . . . . .  D ADDR   009FH   A   
CPT1CN . . . . . .  D ADDR   009AH   A   
CPT1MD . . . . . .  D ADDR   009CH   A   
CPT1MX . . . . . .  D ADDR   009EH   A   
CR . . . . . . . .  B ADDR   00D8H.6 A   
CY . . . . . . . .  B ADDR   00D0H.7 A   
D05MS. . . . . . .  C ADDR   04D9H   A   
D10MS. . . . . . .  C ADDR   04B7H   A   
D1MS . . . . . . .  C ADDR   04C8H   A   
DAT_IN . . . . . .  B ADDR   00B0H.3 A   
DETECT . . . . . .  C ADDR   05C4H   A   
DISP . . . . . . .  C ADDR   0439H   A   
DPH. . . . . . . .  D ADDR   0083H   A   
DPL. . . . . . . .  D ADDR   0082H   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
EIE1 . . . . . . .  D ADDR   00E6H   A   
EIP1 . . . . . . .  D ADDR   00F6H   A   
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    18

EMI0CN . . . . . .  D ADDR   00AAH   A   
EOC3 . . . . . . .  C ADDR   0225H   A   
EOC4 . . . . . . .  C ADDR   04B6H   A   
EOCC . . . . . . .  C ADDR   0597H   A   
EOCD . . . . . . .  C ADDR   0593H   A   
EOCO . . . . . . .  C ADDR   059BH   A   
EOCR . . . . . . .  C ADDR   05BEH   A   
ES0. . . . . . . .  B ADDR   00A8H.4 A   
ESPI0. . . . . . .  B ADDR   00A8H.6 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
ET1. . . . . . . .  B ADDR   00A8H.3 A   
ET2. . . . . . . .  B ADDR   00A8H.5 A   
EX0. . . . . . . .  B ADDR   00A8H.0 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
F0 . . . . . . . .  B ADDR   00D0H.5 A   
F1 . . . . . . . .  B ADDR   00D0H.1 A   
FLACL. . . . . . .  D ADDR   00B5H   A   
FLASH. . . . . . .  C ADDR   0420H   A   
FLKEY. . . . . . .  D ADDR   00B7H   A   
FLSCL. . . . . . .  D ADDR   00B6H   A   
HALF . . . . . . .  C ADDR   0408H   A   
HERE . . . . . . .  C ADDR   0100H   A   
HERE1. . . . . . .  C ADDR   0582H   A   
HERE10 . . . . . .  C ADDR   03D1H   A   
HERE11 . . . . . .  C ADDR   03DBH   A   
HERE12 . . . . . .  C ADDR   0382H   A   
HERE13 . . . . . .  C ADDR   037EH   A   
HERE14 . . . . . .  C ADDR   0397H   A   
HERE15 . . . . . .  C ADDR   0253H   A   
HERE16 . . . . . .  C ADDR   025AH   A   
HERE17 . . . . . .  C ADDR   0561H   A   
HERE18 . . . . . .  C ADDR   0572H   A   
HERE19 . . . . . .  C ADDR   056DH   A   
HERE20 . . . . . .  C ADDR   0435H   A   
HERE21 . . . . . .  C ADDR   01D4H   A   
HERE3. . . . . . .  C ADDR   058FH   A   
HERE4. . . . . . .  C ADDR   057DH   A   
HERE5. . . . . . .  C ADDR   0549H   A   
HERE6. . . . . . .  C ADDR   0544H   A   
HERE7. . . . . . .  C ADDR   0574H   A   
HERE8. . . . . . .  C ADDR   0372H   A   
HERE9. . . . . . .  C ADDR   0385H   A   
IE . . . . . . . .  D ADDR   00A8H   A   
IE0. . . . . . . .  B ADDR   0088H.1 A   
IE1. . . . . . . .  B ADDR   0088H.3 A   
INIT . . . . . . .  C ADDR   0109H   A   
INIT_DEVICE. . . .  C ADDR   077EH   A   
INTERRUPTS_INIT. .  C ADDR   0774H   A   
IP . . . . . . . .  D ADDR   00B8H   A   
IT0. . . . . . . .  B ADDR   0088H.0 A   
IT01CF . . . . . .  D ADDR   00E4H   A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
JUDGE. . . . . . .  C ADDR   0501H   A   
JUMP1. . . . . . .  C ADDR   01C6H   A   
JUMP2. . . . . . .  C ADDR   0170H   A   
JUMP3. . . . . . .  C ADDR   01DCH   A   
K0 . . . . . . . .  C ADDR   0310H   A   
K1 . . . . . . . .  C ADDR   0316H   A   
K2 . . . . . . . .  C ADDR   031CH   A   
K3 . . . . . . . .  C ADDR   0322H   A   
K4 . . . . . . . .  C ADDR   0328H   A   
K5 . . . . . . . .  C ADDR   032EH   A   
K6 . . . . . . . .  C ADDR   0334H   A   
K7 . . . . . . . .  C ADDR   033AH   A   
K8 . . . . . . . .  C ADDR   0340H   A   
K9 . . . . . . . .  C ADDR   0346H   A   
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    19

KA . . . . . . . .  C ADDR   034CH   A   
KB . . . . . . . .  C ADDR   0352H   A   
KC . . . . . . . .  C ADDR   0358H   A   
KD . . . . . . . .  C ADDR   035EH   A   
KE . . . . . . . .  C ADDR   0364H   A   
KF . . . . . . . .  C ADDR   036AH   A   
KINT . . . . . . .  B ADDR   0080H.1 A   
LED. . . . . . . .  B ADDR   0080H.0 A   
LOOP1. . . . . . .  C ADDR   0212H   A   
LOOP10 . . . . . .  C ADDR   04DDH   A   
LOOP11 . . . . . .  C ADDR   04E2H   A   
LOOP12 . . . . . .  C ADDR   04D4H   A   
LOOP13 . . . . . .  C ADDR   04CCH   A   
LOOP14 . . . . . .  C ADDR   04D1H   A   
LOOP15 . . . . . .  C ADDR   04ACH   A   
LOOP2. . . . . . .  C ADDR   0269H   A   
LOOP3. . . . . . .  C ADDR   0467H   A   
LOOP6. . . . . . .  C ADDR   04C3H   A   
LOOP7. . . . . . .  C ADDR   04BBH   A   
LOOP8. . . . . . .  C ADDR   04C0H   A   
LOOP9. . . . . . .  C ADDR   04E5H   A   
LUT1 . . . . . . .  C ADDR   0700H   A   
LUT2 . . . . . . .  C ADDR   0730H   A   
MAIN . . . . . . .  C ADDR   0165H   A   
MASTER . . . . . .  B ADDR   00C0H.7 A   
MCE0 . . . . . . .  B ADDR   0098H.5 A   
MODF . . . . . . .  B ADDR   00F8H.5 A   
NEXT1. . . . . . .  C ADDR   028CH   A   
NEXT10 . . . . . .  C ADDR   0437H   A   
NEXT11 . . . . . .  C ADDR   0508H   A   
NEXT12 . . . . . .  C ADDR   051FH   A   
NEXT13 . . . . . .  C ADDR   050AH   A   
NEXT14 . . . . . .  C ADDR   052DH   A   
NEXT15 . . . . . .  C ADDR   0535H   A   
NEXT16 . . . . . .  C ADDR   0532H   A   
NEXT17 . . . . . .  C ADDR   0529H   A   
NEXT18 . . . . . .  C ADDR   052BH   A   
NEXT19 . . . . . .  C ADDR   05A6H   A   
NEXT2. . . . . . .  C ADDR   03B7H   A   
NEXT20 . . . . . .  C ADDR   05B7H   A   
NEXT6. . . . . . .  C ADDR   01B0H   A   
NEXT7. . . . . . .  C ADDR   03EFH   A   
NEXT8. . . . . . .  C ADDR   03FEH   A   
NEXT9. . . . . . .  C ADDR   042AH   A   
NSSMD0 . . . . . .  B ADDR   00F8H.2 A   
NSSMD1 . . . . . .  B ADDR   00F8H.3 A   
ONE. . . . . . . .  C ADDR   03C6H   A   
OSCICL . . . . . .  D ADDR   00B3H   A   
OSCICN . . . . . .  D ADDR   00B2H   A   
OSCILLATOR_INIT. .  C ADDR   0770H   A   
OSCXCN . . . . . .  D ADDR   00B1H   A   
OV . . . . . . . .  B ADDR   00D0H.2 A   
P. . . . . . . . .  B ADDR   00D0H.0 A   
P0 . . . . . . . .  D ADDR   0080H   A   
P0MDIN . . . . . .  D ADDR   00F1H   A   
P0MDOUT. . . . . .  D ADDR   00A4H   A   
P0SKIP . . . . . .  D ADDR   00D4H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P1MDIN . . . . . .  D ADDR   00F2H   A   
P1MDOUT. . . . . .  D ADDR   00A5H   A   
P1SKIP . . . . . .  D ADDR   00D5H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P2MDIN . . . . . .  D ADDR   00F3H   A   
P2MDOUT. . . . . .  D ADDR   00A6H   A   
P2SKIP . . . . . .  D ADDR   00D6H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    20

P3MDIN . . . . . .  D ADDR   00F4H   A   
P3MDOUT. . . . . .  D ADDR   00A7H   A   
PCA0CN . . . . . .  D ADDR   00D8H   A   
PCA0CPH0 . . . . .  D ADDR   00FCH   A   
PCA0CPH1 . . . . .  D ADDR   00EAH   A   
PCA0CPH2 . . . . .  D ADDR   00ECH   A   
PCA0CPH3 . . . . .  D ADDR   00EEH   A   
PCA0CPH4 . . . . .  D ADDR   00FEH   A   
PCA0CPL0 . . . . .  D ADDR   00FBH   A   
PCA0CPL1 . . . . .  D ADDR   00E9H   A   
PCA0CPL2 . . . . .  D ADDR   00EBH   A   
PCA0CPL3 . . . . .  D ADDR   00EDH   A   
PCA0CPL4 . . . . .  D ADDR   00FDH   A   
PCA0CPM0 . . . . .  D ADDR   00DAH   A   
PCA0CPM1 . . . . .  D ADDR   00DBH   A   
PCA0CPM2 . . . . .  D ADDR   00DCH   A   
PCA0CPM3 . . . . .  D ADDR   00DDH   A   
PCA0CPM4 . . . . .  D ADDR   00DEH   A   
PCA0H. . . . . . .  D ADDR   00FAH   A   
PCA0L. . . . . . .  D ADDR   00F9H   A   
PCA0MD . . . . . .  D ADDR   00D9H   A   
PCA_INIT . . . . .  C ADDR   0734H   A   
PCON . . . . . . .  D ADDR   0087H   A   
PORT_IO_INIT . . .  C ADDR   075AH   A   
PS0. . . . . . . .  B ADDR   00B8H.4 A   
PSCTL. . . . . . .  D ADDR   008FH   A   
PSPI0. . . . . . .  B ADDR   00B8H.6 A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PT0. . . . . . . .  B ADDR   00B8H.1 A   
PT1. . . . . . . .  B ADDR   00B8H.3 A   
PT2. . . . . . . .  B ADDR   00B8H.5 A   
PX0. . . . . . . .  B ADDR   00B8H.0 A   
PX1. . . . . . . .  B ADDR   00B8H.2 A   
RB80 . . . . . . .  B ADDR   0098H.2 A   
REF0CN . . . . . .  D ADDR   00D1H   A   
RELAY1 . . . . . .  C ADDR   02B5H   A   
RELAY2 . . . . . .  C ADDR   0370H   A   
RELAY3 . . . . . .  C ADDR   02D4H   A   
RELAY4 . . . . . .  C ADDR   042CH   A   
REN0 . . . . . . .  B ADDR   0098H.4 A   
RI0. . . . . . . .  B ADDR   0098H.0 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
RS1. . . . . . . .  B ADDR   00D0H.4 A   
RSTSRC . . . . . .  D ADDR   00EFH   A   
RXOVRN . . . . . .  B ADDR   00F8H.4 A   
S0MODE . . . . . .  B ADDR   0098H.7 A   
SBUF0. . . . . . .  D ADDR   0099H   A   
SCON0. . . . . . .  D ADDR   0098H   A   
SETTING. . . . . .  C ADDR   0226H   A   
SHOW . . . . . . .  C ADDR   01E9H   A   
SI . . . . . . . .  B ADDR   00C0H.0 A   
SMB0CF . . . . . .  D ADDR   00C1H   A   
SMB0CN . . . . . .  D ADDR   00C0H   A   
SMB0DAT. . . . . .  D ADDR   00C2H   A   
SP . . . . . . . .  D ADDR   0081H   A   
SPI0CFG. . . . . .  D ADDR   00A1H   A   
SPI0CKR. . . . . .  D ADDR   00A2H   A   
SPI0CN . . . . . .  D ADDR   00F8H   A   
SPI0DAT. . . . . .  D ADDR   00A3H   A   
SPIEN. . . . . . .  B ADDR   00F8H.0 A   
SPIF . . . . . . .  B ADDR   00F8H.7 A   
STA. . . . . . . .  B ADDR   00C0H.5 A   
STA1 . . . . . . .  C ADDR   0228H   A   
STO. . . . . . . .  B ADDR   00C0H.4 A   
T2SPLIT. . . . . .  B ADDR   00C8H.3 A   
T2XCLK . . . . . .  B ADDR   00C8H.0 A   
A51 MACRO ASSEMBLER  SOURCE_CODE                                                          06/02/2020 18:19:37 PAGE    21

TB80 . . . . . . .  B ADDR   0098H.3 A   
TCON . . . . . . .  D ADDR   0088H   A   
TEST1. . . . . . .  C ADDR   027FH   A   
TF0. . . . . . . .  B ADDR   0088H.5 A   
TF1. . . . . . . .  B ADDR   0088H.7 A   
TF2H . . . . . . .  B ADDR   00C8H.7 A   
TF2L . . . . . . .  B ADDR   00C8H.6 A   
TF2LEN . . . . . .  B ADDR   00C8H.5 A   
TH0. . . . . . . .  D ADDR   008CH   A   
TH1. . . . . . . .  D ADDR   008DH   A   
THREE. . . . . . .  C ADDR   039EH   A   
TI0. . . . . . . .  B ADDR   0098H.1 A   
TIMEOUT. . . . . .  C ADDR   03F4H   A   
TIMER0 . . . . . .  C ADDR   04EAH   A   
TIMER1 . . . . . .  C ADDR   0575H   A   
TIMER_INIT . . . .  C ADDR   073BH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TL1. . . . . . . .  D ADDR   008BH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TMR2CN . . . . . .  D ADDR   00C8H   A   
TMR2H. . . . . . .  D ADDR   00CDH   A   
TMR2L. . . . . . .  D ADDR   00CCH   A   
TMR2RLH. . . . . .  D ADDR   00CBH   A   
TMR2RLL. . . . . .  D ADDR   00CAH   A   
TMR3CN . . . . . .  D ADDR   0091H   A   
TMR3H. . . . . . .  D ADDR   0095H   A   
TMR3L. . . . . . .  D ADDR   0094H   A   
TMR3RLH. . . . . .  D ADDR   0093H   A   
TMR3RLL. . . . . .  D ADDR   0092H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
TR1. . . . . . . .  B ADDR   0088H.6 A   
TR2. . . . . . . .  B ADDR   00C8H.2 A   
TWO. . . . . . . .  C ADDR   03BAH   A   
TXBMT. . . . . . .  B ADDR   00F8H.1 A   
TXMODE . . . . . .  B ADDR   00C0H.6 A   
VDM0CN . . . . . .  D ADDR   00FFH   A   
WCOL . . . . . . .  B ADDR   00F8H.6 A   
XBR0 . . . . . . .  D ADDR   00E1H   A   
XBR1 . . . . . . .  D ADDR   00E2H   A   
ZER. . . . . . . .  C ADDR   0412H   A   
ZERO . . . . . . .  C ADDR   03ABH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
